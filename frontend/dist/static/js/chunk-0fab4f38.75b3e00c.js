(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0fab4f38","chunk-ed606062","chunk-2d0ccb97"],{"3f93":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r("7618"),a={error:function(e,t){var r=this.errorHandle(t);e.$message({type:"error",message:r})},errorHandle:function(e){var t="无法完成指定的操作，无法提供信息";return e.message&&"string"==typeof e.message&&(t="",t=e.message),e.message&&"object"==Object(n["a"])(e.message)&&(t=this.errorHandleForEachObject(e.message)),e.errors&&"object"==Object(n["a"])(e.errors)&&(t=this.errorHandleForEachObject(e.errors)),t=t.substr(0,t.length-2),t},errorHandleForEachObject:function(e){var t="";for(var r in e)t=t+e[r].join(",")+"☆";return t},success:function(e,t){e.$message({message:t,type:"success"})},errorTips:function(e,t){e.$message.error({message:t})}}},4271:function(e,t,r){},"4ec3":function(e,t,r){"use strict";r.r(t),r.d(t,"order_baseUrl",function(){return n}),r.d(t,"product_baseUrl",function(){return a}),r.d(t,"package_baseUrl",function(){return o}),r.d(t,"detail_baseUrl",function(){return i}),r.d(t,"log_baseUrl",function(){return s});var n="/api/orders",a="/api/products",o="/api/packages",i="/api/details",s="/api/logs"},"634a":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"config"}},[r("el-form",{staticClass:"demo-form-inline",attrs:{id:"toolbar",inline:!0,model:e.searchForm}},[r("el-form-item",[r("el-input",{attrs:{placeholder:"请输入订单编号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.find(t)}},model:{value:e.searchForm.order_number,callback:function(t){e.$set(e.searchForm,"order_number",t)},expression:"searchForm.order_number"}})],1),e._v(" "),r("el-form-item",[r("el-input",{attrs:{type:"text",placeholder:"请输入商户编号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.find(t)}},model:{value:e.searchForm.merchant_number,callback:function(t){e.$set(e.searchForm,"merchant_number",t)},expression:"searchForm.merchant_number"}})],1),e._v(" "),r("el-form-item",[r("el-input",{attrs:{type:"text",placeholder:"请输入商户名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.find(t)}},model:{value:e.searchForm.merchant_name,callback:function(t){e.$set(e.searchForm,"merchant_name",t)},expression:"searchForm.merchant_name"}})],1),e._v(" "),r("el-form-item",[r("el-select",{attrs:{clearable:"",placeholder:"请选择订单状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[r("el-option",{attrs:{label:"未发",value:"1"}}),e._v(" "),r("el-option",{attrs:{label:"已发未完",value:"2"}}),e._v(" "),r("el-option",{attrs:{label:"已发完",value:"3"}})],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{plain:""},on:{click:function(t){return e.find()}}},[e._v("查询")]),e._v(" "),r("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.findReset()}}},[e._v("重置")])],1)],1),e._v(" "),r("div",{attrs:{id:"datagrid"}},[r("div",{directives:[{name:"permission",rawName:"v-permission",value:["orders.store"],expression:"['orders.store']"}],staticClass:"toolbar"},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["orders.store"],expression:"['orders.store']"}],attrs:{plain:"",icon:"el-icon-plus"},on:{click:function(t){return e.add()}}},[e._v("添加订单信息")])],1),e._v(" "),r("el-col",{attrs:{span:18}},[r("p",{staticClass:"tips",domProps:{innerHTML:e._s(e.summary)}})])],1),e._v(" "),r("el-alert",{attrs:{title:"通过v-permission指令，在普通用户角色下，订单的删除按钮被删除，因为普通用户没有删除操作的权限，请注意查看前端代码的书写格式",type:"error"}})],1),e._v(" "),r("el-table",{directives:[{name:"contextmenu",rawName:"v-contextmenu:contextmenu",arg:"contextmenu"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{size:"mini",data:e.tableData,"row-class-name":e.tableRowClassName,"row-style":e.selectedHighlight,border:""},on:{"row-contextmenu":e.contextHandle,"row-dblclick":e.dblHandle,"row-click":e.rowHandle,"select-all":e.selectChange,"selection-change":e.selectChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),r("el-table-column",{attrs:{label:"订单编号",prop:"order_number",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{label:"商户编号",prop:"merchant_number",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{label:"商户名称",prop:"merchant_name",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{label:"购买时间",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e._f("filterOrderTime")(t.row.order_time)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"订单状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[3===t.row.status?r("el-tag",{attrs:{type:"success"}},[e._v(e._s(e._f("filterStatus")(t.row.status)))]):e._e(),e._v(" "),1===t.row.status?r("el-tag",{attrs:{type:"danger"}},[e._v(e._s(e._f("filterStatus")(t.row.status)))]):e._e(),e._v(" "),2===t.row.status?r("el-tag",{attrs:{type:"info"}},[e._v(e._s(e._f("filterStatus")(t.row.status)))]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"备注",prop:"remark",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{content:"编辑",placement:"right-end",effect:"light"}},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["orders.show"],expression:"['orders.show']"}],attrs:{plain:"",icon:"el-icon-edit",type:"primary",size:"small"},on:{click:function(r){return e.edit(t.row)}}})],1),e._v(" "),r("el-tooltip",{attrs:{content:"编辑",placement:"right-end",effect:"light"}},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["orders.destory"],expression:"['orders.destory']"}],attrs:{plain:"",icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(r){return e.del(t.row,"删除订单，将删除订单对应的所有产品和包裹信息，是否继续")}}})],1)]}}])})],1),e._v(" "),r("el-row",{staticClass:"page"},[r("el-col",{attrs:{span:2,offset:1}}),e._v(" "),r("el-col",{attrs:{span:20}},[r("el-pagination",{attrs:{background:"","current-page":e.current_page,"page-sizes":[10,20,25,50],layout:"total,sizes,prev, pager, next","page-size":e.pageSize,total:e.total},on:{"current-change":e.pagination,"size-change":e.sizeChange,"update:currentPage":function(t){e.current_page=t},"update:current-page":function(t){e.current_page=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"订单管理",center:"",visible:e.editDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editDialogFormVisible=t}}},[r("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"订单编号",prop:"order_number"}},[r("el-input",{attrs:{disabled:!0===e.isEdit,placeholder:"请输入订单编号"},model:{value:e.form.order_number,callback:function(t){e.$set(e.form,"order_number",t)},expression:"form.order_number"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商户编号",prop:"merchant_number"}},[r("el-input",{attrs:{placeholder:"请输入商户编号"},model:{value:e.form.merchant_number,callback:function(t){e.$set(e.form,"merchant_number",t)},expression:"form.merchant_number"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商户名称"}},[r("el-input",{attrs:{placeholder:"请输入商户名称"},model:{value:e.form.merchant_name,callback:function(t){e.$set(e.form,"merchant_name",t)},expression:"form.merchant_name"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"订单日期"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.order_time,callback:function(t){e.$set(e.form,"order_time",t)},expression:"form.order_time"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save()}}},[e._v("确 定")]),e._v(" "),r("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("取 消")])],1)],1),e._v(" "),r("v-contextmenu",{ref:"contextmenu"},[r("v-contextmenu-item",{on:{click:e.add}},[e._v("新增订单")]),e._v(" "),r("v-contextmenu-item",{attrs:{divider:!0}}),e._v(" "),r("v-contextmenu-item",{on:{click:e.editMenuHandle}},[e._v("修改订单")]),e._v(" "),r("v-contextmenu-item",{on:{click:e.deleteHandle}},[e._v("删除定单")]),e._v(" "),r("v-contextmenu-item",{attrs:{divider:!0}})],1)],1)},a=[],o=r("7a88"),i=(r("a297"),r("f8b7"));function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";this.order_number=e,this.merchant_number=t,this.merchant_name=r,this.order_time=n,this.status=a,this.remark=o}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.order_number=e,this.merchant_number=t,this.merchant_name=r,this.status=n}var c={order_number:[{required:!0,message:"请填写订单",trigger:"blur"}],merchant_number:[{required:!0,message:"请填写商户编号",trigger:"blur"}]},u=r("f121"),d=r("3f93"),m={name:"order_index",mixins:[o["a"]],data:function(){return{searchForm:new l,form:new s,rules:c,searchModel:l,model:s,tools:d["a"],showMenu:!1,curd:{getInfo:i["getInfo"]||function(){},getInfoById:i["getInfoById"]||function(){},updateInfo:i["updateInfo"]||function(){},addInfo:i["addInfo"]||function(){},deleteInfoById:i["deleteInfoById"]||function(){},deleteAll:i["deleteAll"]||function(){}},searchSelect:"order_number",searchContent:"",types:["无"],templateFile:u["a"].site+"/xls/config.xlsx",goods:[],getIndex:null,editDialogFormVisible:!1,currentRecord:null,product_count:0,sum_amount:0,sum_remain:0}},created:function(){this.fetchData()},computed:{summary:function(){return this.product_count?"当前订单有产品 <span>".concat(this.product_count," </span>类,  合计 <span>").concat(this.sum_amount," </span>件商品,  已经发送 <span>").concat(this.sum_amount-this.sum_remain," </span>件,  还剩<span>").concat(this.sum_remain,"</span>件未发送"):""}},filters:{filterOrderTime:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()},filterStatus:function(e){var t=["","未发","已发未完","已发完"];return t[e]}},methods:{showContent:function(e){this.$router.push({path:"/order/"+e+"/products"})},showPackage:function(e){this.$router.push({path:"/order/"+e+"/package"})},editMenuHandle:function(e){this.edit({id:this.currentRecord})},deleteHandle:function(){this.del({id:this.currentRecord},"删除订单，将删除订单对应的所有产品和包裹信息，是否继续")},find:function(e){var t=this;this.$nextTick().then(function(){t.fetchData()})},dblHandle:function(e,t,r){this.edit(e)},rowHandle:function(e,t,r){this.getIndex=e.index,this.getSummary(e.id)},getSummary:function(e){var t=this;Object(i["getSummaryById"])(e).then(function(e){var r=e.data,n=r.product_count,a=r.sum_amount,o=r.sum_remain;t.product_count=n,t.sum_amount=a,t.sum_remain=o})},contextHandle:function(e,t,r){this.getIndex=e.index,this.currentRecord=e.id,this.getSummary(e.id)},tableRowClassName:function(e){var t=e.row,r=e.rowIndex;t.index=r},selectedHighlight:function(e){e.row;var t=e.rowIndex;if(this.getIndex===t)return{"background-color":"#CAE1ff"}},testMenu:function(){console.log("test")}}},f=m,h=(r("dac8"),r("2877")),p=Object(h["a"])(f,n,a,!1,null,null,null);t["default"]=p.exports},"7a88":function(e,t,r){"use strict";r("ac6a");var n={data:function(){return{tableData:[],editDialogFormVisible:!1,uploadId:"",teachers:[],loading:!1,isNew:!1,isEdit:!1,current_page:1,total:0,pageSize:10}},methods:{search:function(e){document.querySelector(".el-input__inner");this.fetchData()},find:function(){this.fetchData()},findReset:function(){var e=this.searchModel;this.searchForm=new e,this.fetchData()},fetchData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.searchForm,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.current_page,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pageSize;this.loading=!0,this.curd.getInfo(t,r,n).then(function(t){if("function"===typeof e.listHandle)e.listHandle(t);else{var r=t.data;e.tableData=r}e.total=t.meta.total,e.loading=!1}).catch(function(t){e.tools.error(e,t.response.data),e.loading=!1})},add:function(){var e=this.model;this.form=new e,this.editDialogFormVisible=!0,this.isNew=!0},save:function(){var e=this;this.$refs["ruleForm"].validate(function(t){if(!t)return!1;e.editDialogFormVisible=!1,e.isNew&&(e.isNew=!1,e.newData()),e.isEdit&&(e.isEdit=!1,e.updateData())})},cancel:function(){this.editDialogFormVisible=!1,this.isNew=!1,this.isEdit=!1},edit:function(e){var t=this,r=e.id;this.uploadId=r,this.curd.getInfoById(r).then(function(e){if("function"===typeof t.editHandle)t.editHandle(e);else{var r=e.data;t.form=r}t.isEdit=!0,t.editDialogFormVisible=!0})},updateData:function(){var e=this;this.curd.updateInfo(this.uploadId,this.form).then(function(t){var r=t.status_code;200==r&&(e.fetchData(),e.tools.success(e,"信息更新成功"))}).catch(function(t){e.tools.error(e,t.response.data)})},newData:function(){var e=this;this.curd.addInfo(this.form).then(function(t){e.tools.success(e,"功能信息添加成功"),e.fetchData()}).catch(function(t){e.tools.error(e,t.response.data)})},del:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"此操作将永久删除该信息, 是否继续?";this.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var r=e.id;t.curd.deleteInfoById(r).then(function(e){var r=e.status_code;200==r&&(t.$message({type:"success",message:"删除成功!"}),t.fetchData())}).catch(function(e){t.tools.error(t,e.response.data)})})},selectChange:function(e){this.multiSelect=e},delAll:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"此操作将永久删除该功能, 是否继续?";this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=[];e.multiSelect.forEach(function(e){t.push(e.id)}),e.curd.deleteAll(t).then(function(t){e.fetchData()}).catch(function(t){e.tools.error(t.response.data)})}).catch(function(){e.tools.errorTips(e,"删除操作已经取消")})},pagination:function(e){this.current_page=e,this.fetchData()},sizeChange:function(e){this.pageSize=e,this.fetchData()}},mounted:function(){},created:function(){}};t["a"]=n},a297:function(e,t,r){"use strict"},dac8:function(e,t,r){"use strict";var n=r("4271"),a=r.n(n);a.a},f8b7:function(e,t,r){"use strict";r.r(t),r.d(t,"getInfo",function(){return o}),r.d(t,"getInfoById",function(){return i}),r.d(t,"updateInfo",function(){return s}),r.d(t,"deleteInfoById",function(){return l}),r.d(t,"addInfo",function(){return c}),r.d(t,"deleteAll",function(){return u}),r.d(t,"getProductsById",function(){return d}),r.d(t,"getEnableProductsById",function(){return m}),r.d(t,"getSummaryById",function(){return f});var n=r("1c1e"),a=r("4ec3");function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3?arguments[3]:void 0;return Object(n["a"])({url:a["order_baseUrl"],method:"get",params:{id:o,page:t,pageSize:r,order_number:e.order_number,merchant_number:e.merchant_number,merchant_name:e.merchant_name,status:e.status}})}function i(e){return Object(n["a"])({url:a["order_baseUrl"]+"/"+e,method:"get"})}function s(e,t){return"string"===typeof t.order_time?t.order_time=Math.ceil(Date.parse(t.order_time)/1e3):t.order_time=Math.ceil(t.order_time.getTime()/1e3),Object(n["a"])({url:a["order_baseUrl"]+"/"+e,method:"PATCH",data:t})}function l(e){return Object(n["a"])({url:a["order_baseUrl"]+"/"+e,method:"delete"})}function c(e){return e.order_time=Math.ceil(e.order_time.getTime()/1e3),Object(n["a"])({url:a["order_baseUrl"],method:"post",data:e})}function u(e){return Object(n["a"])({url:a["order_baseUrl"]+"/deleteAll",method:"post",data:{ids:e}})}function d(e){return Object(n["a"])({url:a["order_baseUrl"]+"/"+e+"/products",method:"get"})}function m(e){return Object(n["a"])({url:a["order_baseUrl"]+"/"+e+"/enable",method:"get"})}function f(e){return Object(n["a"])({url:a["order_baseUrl"]+"/"+e+"/summary",method:"get"})}}}]);